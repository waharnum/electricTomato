<!DOCTYPE html>
<html>
<head>
<title>Electric Tomato</title>
<script>window.$ = window.jQuery = require('jquery');</script>
</head>
<body>
    <h1>Countdown</h1>
    <div id="countdown"></div>
    <form>
        <div class="buttonContainer"><button id="pomodoro">Pomodoro</button></div>
        <div class="buttonContainer"><button id="shortBreak">Short Break</button></div>
        <div class="buttonContainer"><button id="longBreak">Long Break</button></div>
    </form>

  <script>
    var timerId;
    var currentTime;

    var startTimer = function (seconds) {
        window.clearTimeout(timerId);
        var countdown = $("#countdown");
        countdown.text(formatTimer(seconds));
        currentTime = seconds;
        timerId = window.setTimeout(decreaseTimer, 1000);
    };

    var bindClick = function (id, seconds) {
        $("#"+id).click(function (e) {
            startTimer(seconds);
            e.preventDefault();
        });
    };

    // Given a number of seconds, returns a timer minutes/seconds representation
    var formatTimer = function (seconds) {
        var minutes = Math.floor(seconds / 60);
        var seconds = seconds % 60;
        var displayedSeconds = seconds === 0 ? "00" : seconds;
        return minutes + ":" + displayedSeconds;
    };

    function decreaseTimer() {
        var countdown = $("#countdown");
        currentTime--;
        countdown.text(formatTimer(currentTime));
        if(currentTime > 0) {
            timerId = window.setTimeout(decreaseTimer, 1000)
        } else {
            new Notification("Countdown Complete", {title: "Countdown Complete", body: "The countdown is complete"})
        }
    };

    bindClick("pomodoro", 25*60);
    bindClick("shortBreak", 5*60);
    bindClick("longBreak", 15*60);

  </script>
</body>
</html>
